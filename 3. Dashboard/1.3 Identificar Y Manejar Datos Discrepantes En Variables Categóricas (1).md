# **1.3 Identificar Y Manejar Datos Discrepantes En Variables Categ√≥ricas**

## **amazon_product_clean**
```sql
SELECT 
    SPLIT(category, '|')[SAFE_OFFSET(0)] AS primary_category
FROM 
    `datalab-433117.dataset.amazon_product_clean`;


CREATE OR REPLACE TABLE `datalab-433117.dataset.amazon_product_clean` AS
SELECT 
    *,
    SPLIT(category, '|')[SAFE_OFFSET(0)] AS primary_category
FROM 
    `datalab-433117.dataset.amazon_product_clean`;
```

----------------------------------
----------------------------------

## **amazon_review_cleaned**

```sql
SELECT 
  review_id, 
  user_id, 
  review_title, 
  review_content
FROM 
  `datalab-433117.dataset.amazon_review_cleaned`
WHERE 
  REGEXP_CONTAINS(review_title, r'[^\x00-\x7F]') 
  OR REGEXP_CONTAINS(review_content, r'[^\x00-\x7F]');
```
