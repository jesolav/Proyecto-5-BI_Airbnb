# **1.3 Identificar Y Manejar Datos Discrepantes En Variables NÃºmericas**

## **reviews**

En columna number_of_reviews, se identifican 136 filas con datos en formato de fecha 

```sql
SELECT *
FROM `proyecto-5-435916.data.reviews`
WHERE SAFE_CAST(number_of_reviews AS INT64) IS NULL
AND number_of_reviews IS NOT NULL;
```

![image](https://github.com/user-attachments/assets/4884c785-af12-42bb-a38e-f7b5ce00571c)

Se reemplazan los datos que estan en formato fecha por "0"
```sql
CREATE OR REPLACE TABLE `proyecto-5-435916.data.reviews` AS
SELECT 
    id,
    host_id,
    price,
    CASE 
        WHEN SAFE_CAST(number_of_reviews AS INT64) IS NULL THEN '0'
        ELSE number_of_reviews
    END AS number_of_reviews,
    last_review,
    reviews_per_month,
    calculated_host_listings_count,
    availability_365
FROM 
    `proyecto-5-435916.data.reviews`;
```

![image](https://github.com/user-attachments/assets/600a5ecf-e536-427e-9c1f-aa73c94d80dd)


----------------------------------
----------------------------------

## **amazon_review_cleaned**

```sql
SELECT 
  review_id, 
  user_id, 
  review_title, 
  review_content
FROM 
  `datalab-433117.dataset.amazon_review_cleaned`
WHERE 
  REGEXP_CONTAINS(review_title, r'[^\x00-\x7F]') 
  OR REGEXP_CONTAINS(review_content, r'[^\x00-\x7F]');
```
