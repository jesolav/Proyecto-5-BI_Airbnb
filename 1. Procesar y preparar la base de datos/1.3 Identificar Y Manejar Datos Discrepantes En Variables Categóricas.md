# **1.3 Identificar Y Manejar Datos Discrepantes En Variables Númericas**

## **reviews**

Se detectan 10175 datos de last_review inconsistentes, como: 4.2, 5.34, 6,3, se decide reemplazar estos valores no válidos con una fecha ficticia, como '1900-01-01', lo que permitirá identificar estos casos en el análisis.

```sql
CREATE OR REPLACE TABLE `proyecto-5-435916.data.reviews_cleaned` AS
SELECT
    CAST(id AS STRING) AS id,
    CAST(host_id AS STRING) AS host_id,
    price,
    SAFE_CAST(number_of_reviews AS INT64) AS number_of_reviews, -- Convertir a INT64 si es posible
    -- Validar si `last_review` es una fecha correcta y reemplazar los valores inconsistentes
    CASE
        WHEN REGEXP_CONTAINS(last_review, r'^\d{4}-\d{2}-\d{2}$') THEN PARSE_DATE('%Y-%m-%d', last_review) -- Formato válido
        ELSE DATE '1900-01-01' -- Fecha ficticia para valores no válidos
    END AS last_review,
    reviews_per_month,
    calculated_host_listings_count,
    availability_365
FROM
    `proyecto-5-435916.data.reviews`;
```




Otras tablas no se realizaron modificaciones.
